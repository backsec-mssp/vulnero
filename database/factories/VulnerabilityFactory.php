<?php

use Faker\Generator as Faker;

$factory->define(App\Vulnerability::class, function (Faker $faker) {
    // base score CVSS metrics
    $cvssMapping = [
        'AV' => ['N', 'A', 'L', 'P'],
        'AC' => ['L', 'H'],
        'PR' => ['N', 'L', 'H'],
        'UI' => ['N', 'R'],
        'S' => ['U', 'C'],
        'C' => ['N', 'L', 'H'],
        'I' => ['N', 'L', 'H'],
        'A' => ['N', 'L', 'H'],
    ];

    $cvss = '';
    foreach ($cvssMapping as $metric => $options) {
        $cvss .= $metric . ':' . array_random($options);
        if ($metric !== 'A') {
            $cvss .= '/';
        }
    }

    return [
        'title' => $faker->sentence(6),
        'description' => $faker->text(500),
        'cvss_vector' => $cvss,
        'cwe_id' => rand(1, 1000),
        'asset_id' => factory(\App\Asset::class)->create()->id,
    ];
});
